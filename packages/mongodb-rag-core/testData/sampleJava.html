<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="MongoDB Java Driver documentation" />
    <meta name="author" content="MongoDB Drivers Team" />
    <meta
      name="keyword"
      content="MongoDB, Java, JVM, NoSQL, Document Database"
    />
    <meta name="date" content="2023-06-22T14:36:32.11" />
    <link rel="shortcut icon" href="/mongo-java-driver/4.10/img/favicon.png" />

    <title>Aggregation</title>
    <link
      rel="stylesheet"
      href="/mongo-java-driver/4.10/lib/bootstrap.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/mongo-java-driver/4.10/lib/font-awesome/css/font-awesome.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/mongo-java-driver/4.10/css/mongodb-docs.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/mongo-java-driver/4.10/css/overrides.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/mongo-java-driver/4.10/lib/highlight/styles/idea.css"
    />
    <link
      rel="stylesheet"
      href="/mongo-java-driver/4.10/lib/bootstrap-toggle/bootstrap-toggle.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/mongo-java-driver/4.10/css/java.css"
      type="text/css"
    />
  </head>

  <body>
    <section id="container" class="">
      <header id="header-db" class="row" role="navigation">
        <div class="header-content">
          <div class="toggle-nav pull-left">
            <i class="fa fa-bars"></i>
            <div
              class="icon-reorder tooltips"
              data-original-title="Toggle Navigation"
              data-placement="bottom"
            ></div>
          </div>

          <div class="logo pull-left">
            <a href="/mongo-java-driver/4.10/../">
              <img
                src="/mongo-java-driver/4.10/img/logo-mongodb-header.png"
                ,
                alt="MongoDB"
              />
            </a>
          </div>

          <div>
            <div class="nav-items pull-right">
              <a
                href="https://university.mongodb.com"
                data-toggle="tooltip"
                data-placement="bottom"
                title="Free Online Classes"
                >MongoDB University</a
              >
              <a
                href="https://www.mongodb.com/try"
                data-toggle="tooltip"
                data-placement="bottom"
                title="Download MongoDB"
                >Downloads</a
              >
              <a
                href="https://www.mongodb.com/community"
                data-toggle="tooltip"
                data-placement="bottom"
                title="Get involved with MongoDB"
                >Community</a
              >
              <a
                href="https://www.mongodb.com/docs"
                data-toggle="tooltip"
                data-placement="bottom"
                title="The MongoDB Documentation"
                >Docs</a
              >
              <a
                href="https://www.mongodb.com/blog"
                data-toggle="tooltip"
                data-placement="bottom"
                title="The MongoDB Blog"
                >Blog</a
              >
              <div id="search">
                <form
                  method="get"
                  action="//www.google.com/search"
                  target="_blank"
                >
                  <input
                    type="text"
                    name="searchQuery"
                    size="20"
                    value=""
                    autocomplete="off"
                    placeholder="Search docs"
                  />
                  <input
                    type="hidden"
                    name="site"
                    value="/mongo-java-driver/4.10"
                  />
                  <input type="hidden" name="q" value="" />
                  <label for="searchQuery"
                    ><i class="fa fa-search fa-1"></i
                  ></label>
                </form>
              </div>
            </div>
          </div>
        </div>
      </header>

      <aside id="sidebar" class="sidebar">
        <div class="ssidebar nav-collapse">
          <div class="ssidebarwrapper">
            <h3>
              <a class="index-link" href="/mongo-java-driver/4.10/../"
                >MongoDB JVM Drivers</a
              >
              <a class="version pull-right" href="/mongo-java-driver/4.10"
                >4.10.0</a
              >
            </h3>

            <ul class="sidebar-menu">
              <li class="toctree-l1">
                <a href="/mongo-java-driver/4.10/whats-new/"
                  ><i class="fa fa-level-up"></i>What&#39;s New</a
                >
              </li>
              <li class="toctree-l1">
                <a href="/mongo-java-driver/4.10/driver/" class=""
                  ><i class="fa fa-arrows-h"></i><span>Java Driver</span
                  ><span class="menu-arrow fa fa-angle-right"></span
                ></a>
                <ul>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver/getting-started/installation/"
                      ><i class="fa"></i>Installation</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver/getting-started/quick-start/"
                      ><i class="fa"></i>Quick Start</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver/getting-started/quick-start-pojo/"
                      ><i class="fa"></i>Quick Start - POJOs</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/driver/tutorials/" class=""
                      ><i class="fa fa-thumb-tack"></i><span>Tutorials</span></a
                    >
                    <ul>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/connect-to-mongodb/"
                          class=""
                          ><i class="fa"></i><span>Connect to MongoDB</span></a
                        >
                        <ul>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver/tutorials/ssl/"
                              ><i class="fa"></i>TLS/SSL</a
                            >
                          </li>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver/tutorials/authentication/"
                              ><i class="fa"></i>Authentication</a
                            >
                          </li>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver/tutorials/compression/"
                              ><i class="fa"></i>Compression</a
                            >
                          </li>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver/tutorials/jndi/"
                              ><i class="fa"></i>JNDI</a
                            >
                          </li>
                        </ul>
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/databases-collections/"
                          ><i class="fa"></i>Databases and Collections</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/indexes/"
                          ><i class="fa"></i>Create Indexes</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/perform-read-operations/"
                          ><i class="fa"></i>Read Operations</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/client-side-encryption/"
                          ><i class="fa fa-lock"></i>Client Side Encryption</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/perform-write-operations/"
                          class=""
                          ><i class="fa"></i><span>Write Operations</span></a
                        >
                        <ul>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver/tutorials/bulk-writes/"
                              ><i class="fa"></i>Bulk Writes</a
                            >
                          </li>
                        </ul>
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/aggregation/"
                          ><i class="fa"></i>Aggregation</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/change-streams/"
                          ><i class="fa"></i>Change Streams</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/text-search/"
                          ><i class="fa"></i>Text Search</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/geospatial-search/"
                          ><i class="fa"></i>Geospatial Search</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/gridfs/"
                          ><i class="fa"></i>GridFS</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/tutorials/commands/"
                          ><i class="fa"></i>Run Commands</a
                        >
                      </li>
                    </ul>
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/driver/reference/" class=""
                      ><i class="fa fa-book"></i><span>Reference</span></a
                    >
                    <ul>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/reference/logging/"
                          ><i class="fa"></i>Logging</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver/reference/monitoring/"
                          ><i class="fa"></i>Monitoring</a
                        >
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li class="toctree-l1 current">
                <a href="/mongo-java-driver/4.10/driver-reactive/" class=""
                  ><i class="fa fa-refresh"></i><span>Reactive Streams</span
                  ><span class="menu-arrow fa fa-angle-down"></span
                ></a>
                <ul class="current">
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-reactive/getting-started/installation/"
                      ><i class="fa"></i>Installation</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-reactive/getting-started/quick-start/"
                      ><i class="fa"></i>Quick Start</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-reactive/getting-started/quick-start-pojo/"
                      ><i class="fa"></i>Quick Start - POJOs</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-reactive/getting-started/quick-start-primer/"
                      ><i class="fa"></i>Quick Start Primer</a
                    >
                  </li>
                  <li class="toctree-l2 current">
                    <a
                      href="/mongo-java-driver/4.10/driver-reactive/tutorials/"
                      class=""
                      ><i class="fa fa-thumb-tack"></i><span>Tutorials</span></a
                    >
                    <ul class="current">
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/connect-to-mongodb/"
                          class=""
                          ><i class="fa"></i><span>Connect to MongoDB</span></a
                        >
                        <ul>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver-reactive/tutorials/ssl/"
                              ><i class="fa"></i>TLS/SSL</a
                            >
                          </li>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver-reactive/tutorials/authentication/"
                              ><i class="fa"></i>Authentication</a
                            >
                          </li>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver-reactive/tutorials/compression/"
                              ><i class="fa"></i>Compression</a
                            >
                          </li>
                        </ul>
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/databases-collections/"
                          ><i class="fa"></i>Databases and Collections</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/indexes/"
                          ><i class="fa"></i>Create Indexes</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/perform-read-operations/"
                          ><i class="fa"></i>Read Operations</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/client-side-encryption/"
                          ><i class="fa fa-lock"></i>Client Side Encryption</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/perform-write-operations/"
                          class=""
                          ><i class="fa"></i><span>Write Operations</span></a
                        >
                        <ul>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver-reactive/tutorials/bulk-writes/"
                              ><i class="fa"></i>Bulk Writes</a
                            >
                          </li>
                        </ul>
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/aggregation/"
                          ><i class="fa"></i>Aggregation</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/change-streams/"
                          ><i class="fa"></i>Change Streams</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/text-search/"
                          ><i class="fa"></i>Text Search</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/geospatial-search/"
                          ><i class="fa"></i>Geospatial Search</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/gridfs/"
                          ><i class="fa"></i>GridFS</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/commands/"
                          ><i class="fa"></i>Run Commands</a
                        >
                      </li>
                    </ul>
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-reactive/reference/"
                      class=""
                      ><i class="fa fa-book"></i><span>Reference</span></a
                    >
                    <ul>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/reference/logging/"
                          ><i class="fa"></i>Logging</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/reference/monitoring/"
                          ><i class="fa"></i>Monitoring</a
                        >
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li class="toctree-l1">
                <a href="/mongo-java-driver/4.10/bson/" class=""
                  ><i class="fa fa-th"></i><span>BSON</span
                  ><span class="menu-arrow fa fa-angle-right"></span
                ></a>
                <ul>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/bson/documents/"
                      ><i class="fa"></i>Documents</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/bson/readers-and-writers/"
                      ><i class="fa"></i>Readers and Writers</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/bson/codecs/"
                      ><i class="fa"></i>Codec and CodecRegistry</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/bson/pojos/"
                      ><i class="fa fa-star"></i>POJOs</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/bson/extended-json/"
                      ><i class="fa"></i>Extended JSON</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/bson/installation-guide/"
                      ><i class="fa"></i>Installation Guide</a
                    >
                  </li>
                </ul>
              </li>
              <li class="toctree-l1">
                <a href="/mongo-java-driver/4.10/builders/" class=""
                  ><i class="fa fa-wrench"></i><span>Builders</span
                  ><span class="menu-arrow fa fa-angle-right"></span
                ></a>
                <ul>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/builders/filters/"
                      ><i class="fa"></i>Filters</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/builders/projections/"
                      ><i class="fa"></i>Projections</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/builders/sorts/"
                      ><i class="fa"></i>Sort Criteria
                    </a>
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/builders/aggregation/"
                      ><i class="fa"></i>Aggregates</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/builders/updates/"
                      ><i class="fa"></i>Updates</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a href="/mongo-java-driver/4.10/builders/indexes/"
                      ><i class="fa"></i>Indexes</a
                    >
                  </li>
                </ul>
              </li>
              <li class="toctree-l1">
                <a href="/mongo-java-driver/4.10/driver-scala/" class=""
                  ><i class="fa fa-refresh"></i><span>Scala Driver</span
                  ><span class="menu-arrow fa fa-angle-right"></span
                ></a>
                <ul>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-scala/getting-started/installation/"
                      ><i class="fa"></i>Installation</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-scala/getting-started/quick-start/"
                      ><i class="fa"></i>Quick Start</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-scala/getting-started/quick-start-case-class/"
                      ><i class="fa"></i>Quick Start - Case Classes</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-scala/getting-started/quick-start-primer/"
                      ><i class="fa"></i>Quick Start Primer</a
                    >
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-scala/tutorials/"
                      class=""
                      ><i class="fa fa-thumb-tack"></i><span>Tutorials</span></a
                    >
                    <ul>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/connect-to-mongodb/"
                          class=""
                          ><i class="fa"></i><span>Connect to MongoDB</span></a
                        >
                        <ul>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver-scala/tutorials/ssl/"
                              ><i class="fa"></i>TLS/SSL</a
                            >
                          </li>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver-scala/tutorials/authentication/"
                              ><i class="fa"></i>Authentication</a
                            >
                          </li>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver-scala/tutorials/compression/"
                              ><i class="fa"></i>Compression</a
                            >
                          </li>
                        </ul>
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/databases-collections/"
                          ><i class="fa"></i>Databases and Collections</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/indexes/"
                          ><i class="fa"></i>Create Indexes</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/perform-read-operations/"
                          ><i class="fa"></i>Read Operations</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/client-side-encryption/"
                          ><i class="fa fa-lock"></i>Client Side Encryption</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/perform-write-operations/"
                          class=""
                          ><i class="fa"></i><span>Write Operations</span></a
                        >
                        <ul>
                          <li class="toctree-l4">
                            <a
                              href="/mongo-java-driver/4.10/driver-scala/tutorials/bulk-writes/"
                              ><i class="fa"></i>Bulk Writes</a
                            >
                          </li>
                        </ul>
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/aggregation/"
                          ><i class="fa"></i>Aggregation</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/change-streams/"
                          ><i class="fa"></i>Change Streams</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/text-search/"
                          ><i class="fa"></i>Text Search</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/geospatial-search/"
                          ><i class="fa"></i>Geospatial Search</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/gridfs/"
                          ><i class="fa"></i>GridFS</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/tutorials/commands/"
                          ><i class="fa"></i>Run Commands</a
                        >
                      </li>
                    </ul>
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-scala/reference/"
                      class=""
                      ><i class="fa fa-book"></i><span>Reference</span></a
                    >
                    <ul>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/reference/logging/"
                          ><i class="fa"></i>Logging</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/reference/monitoring/"
                          ><i class="fa"></i>Monitoring</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/reference/observables/"
                          ><i class="fa"></i>Observables</a
                        >
                      </li>
                    </ul>
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-scala/bson/"
                      class=""
                      ><i class="fa fa-th"></i><span>BSON</span></a
                    >
                    <ul>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/bson/scala-documents/"
                          ><i class="fa"></i>Documents</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/bson/macros/"
                          ><i class="fa fa-cog"></i>Macros</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/bson/scala-extended-json/"
                          ><i class="fa"></i>Extended JSON</a
                        >
                      </li>
                    </ul>
                  </li>
                  <li class="toctree-l2">
                    <a
                      href="/mongo-java-driver/4.10/driver-scala/builders/"
                      class=""
                      ><i class="fa fa-wrench"></i><span>Builders</span></a
                    >
                    <ul>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/builders/filters/"
                          ><i class="fa"></i>Filters</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/builders/projections/"
                          ><i class="fa"></i>Projections</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/builders/sorts/"
                          ><i class="fa"></i>Sort Criteria</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/builders/aggregation/"
                          ><i class="fa"></i>Aggregation</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/builders/updates/"
                          ><i class="fa"></i>Updates</a
                        >
                      </li>
                      <li class="toctree-l3">
                        <a
                          href="/mongo-java-driver/4.10/driver-scala/builders/indexes/"
                          ><i class="fa"></i>Indexes</a
                        >
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li class="toctree-l1">
                <a href="/mongo-java-driver/4.10/upgrading/"
                  ><i class="fa fa-level-up"></i>Upgrade Considerations</a
                >
              </li>
              <li class="toctree-l1">
                <a href="/mongo-java-driver/4.10/apidocs/"
                  ><i class="fa fa-file-text-o"></i>API Documentation</a
                >
              </li>
              <li class="toctree-l1">
                <a
                  href="https://github.com/mongodb/mongo-java-driver/tree/master"
                  ><i class="fa fa-github"></i>Source Code</a
                >
              </li>
              <li class="toctree-l1">
                <a href="/mongo-java-driver/4.10/issues-help/"
                  ><i class="fa fa-life-ring"></i>Issues &amp; Help</a
                >
              </li>
            </ul>
          </div>
        </div>
      </aside>

      <section id="main-content" class="content">
        <section class="main-column pull-left">
          <div class="document">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  <a
                    class="edit-link"
                    href="https://github.com/mongodb/mongo-java-driver/blob/master/docs/reference/content/driver-reactive/tutorials/aggregation.md"
                    target="_blank"
                    title="Edit driver-reactive/tutorials/aggregation.md on GitHub"
                    ><i class="fa fa-pencil-square-o"></i
                  ></a>
                  <div class="bc">
                    <ul>
                      <li>
                        <a href="/mongo-java-driver/4.10/driver-reactive/"
                          >Reactive Streams</a
                        >
                        <i class="fa fa-angle-right"></i>
                      </li>
                      <li>
                        <a
                          href="/mongo-java-driver/4.10/driver-reactive/tutorials/"
                          >Tutorials</a
                        >
                        <i class="fa fa-angle-right"></i>
                      </li>
                      <li>Aggregation</li>
                    </ul>
                  </div>

                  <h2 id="aggregation-framework">Aggregation Framework</h2>

                  <p>
                    The
                    <a
                      href="https://www.mongodb.org/docs/manual/core/aggregation-pipeline
"
                      >aggregation pipeline</a
                    >
                    is a framework for data aggregation, modeled on the concept
                    of data processing pipelines.
                  </p>

                  <h2 id="prerequisites">Prerequisites</h2>

                  <ul>
                    <li>
                      <p>
                        The example below requires a
                        <code>restaurants</code> collection in the
                        <code>test</code> database. To create and populate the
                        collection, follow the directions in
                        <a
                          href="https://github.com/mongodb/docs-assets/tree/drivers"
                          >github</a
                        >.
                      </p>
                    </li>

                    <li>
                      <p>Include the following import statements:</p>

                      <pre><code class="language-java"> import com.mongodb.reactivestreams.client.MongoClients;
 import com.mongodb.reactivestreams.client.MongoClient;
 import com.mongodb.reactivestreams.client.MongoCollection;
 import com.mongodb.reactivestreams.client.MongoDatabase;
 import com.mongodb.client.model.Aggregates;
 import com.mongodb.client.model.Accumulators;
 import com.mongodb.client.model.Projections;
 import com.mongodb.client.model.Filters;
     
 import org.bson.Document;
</code></pre>
                    </li>
                  </ul>

                  <div class="admonition important">
                    <h5 class="admonition-title">important</h5>
                    <p>
                      This guide uses the
                      <code>Subscriber</code> implementations as covered in the
                      <a
                        href="/mongo-java-driver/4.10/driver-reactive/getting-started/quick-start-primer/"
                        >Quick Start Primer</a
                      >.
                    </p>
                  </div>

                  <h2 id="connect-to-a-mongodb-deployment">
                    Connect to a MongoDB Deployment
                  </h2>

                  <p>
                    Connect to a MongoDB deployment and declare and define a
                    <code>MongoDatabase</code> and a
                    <code>MongoCollection</code> instances.
                  </p>

                  <p>
                    For example, include the following code to connect to a
                    standalone MongoDB deployment running on localhost on port
                    <code>27017</code> and define <code>database</code> to refer
                    to the <code>test</code> database and
                    <code>collection</code> to refer to the
                    <code>restaurants</code> collection.
                  </p>

                  <pre><code class="language-java">MongoClient mongoClient = MongoClients.create();
MongoDatabase database = mongoClient.getDatabase(&quot;test&quot;);
MongoCollection&lt;Document&gt; collection = database.getCollection(&quot;restaurants&quot;);
</code></pre>

                  <p>
                    For additional information on connecting to MongoDB, see
                    <a
                      href="/mongo-java-driver/4.10/driver/tutorials/connect-to-mongodb/"
                      >Connect to MongoDB</a
                    >.
                  </p>

                  <h2 id="perform-aggregation">Perform Aggregation</h2>

                  <p>
                    To perform aggregation, pass a list of
                    <a
                      href="https://www.mongodb.org/docs/manual/meta/aggregation-quick-reference
"
                      >aggregation stages</a
                    >
                    to the
                    <a
                      href="/mongo-java-driver/4.10/apidocs/mongodb-driver-sync/com/mongodb/client/MongoCollection.html#aggregate(java.util.List)
"
                      ><code>MongoCollection.aggregate()</code></a
                    >
                    method. The Java driver provides the
                    <a
                      href="/mongo-java-driver/4.10/apidocs/mongodb-driver-core/com/mongodb/client/model/Aggregates.html
"
                      ><code>Aggregates</code></a
                    >
                    helper class that contains builders for aggregation stages.
                  </p>

                  <p>In the following example, the aggregation pipeline</p>

                  <ul>
                    <li>
                      <p>
                        First uses a
                        <a
                          href="https://www.mongodb.org/docs/manual/reference/operator/aggregation/match/
"
                          ><code>$match</code></a
                        >
                        stage to filter for documents whose
                        <code>categories</code> array field contains the element
                        <code>Bakery</code>. The example uses
                        <a
                          href="/mongo-java-driver/4.10/builders/aggregation/#match"
                          ><code>Aggregates.match</code></a
                        >
                        to build the <code>$match</code> stage.
                      </p>
                    </li>

                    <li>
                      <p>
                        Then, uses a
                        <a
                          href="https://www.mongodb.org/docs/manual/reference/operator/aggregation/group/
"
                          ><code>$group</code></a
                        >
                        stage to group the matching documents by the
                        <code>stars</code> field, accumulating a count of
                        documents for each distinct value of <code>stars</code>.
                        The example uses
                        <a
                          href="/mongo-java-driver/4.10/builders/aggregation/#group"
                          ><code>Aggregates.group</code></a
                        >
                        to build the <code>$group</code> stage and
                        <a
                          href="/mongo-java-driver/4.10/apidocs/mongodb-driver-core/com/mongodb/client/model/Accumulators#sum(java.lang.String,TExpression).html
"
                          ><code>Accumulators.sum</code></a
                        >
                        to build the
                        <a
                          href="https://www.mongodb.org/docs/manual/reference/operator/aggregation/group/#accumulator-operator
"
                          >accumulator expression</a
                        >. For the
                        <a
                          href="https://www.mongodb.org/docs/manual/reference/operator/aggregation-group/
"
                          >accumulator expressions</a
                        >
                        for use within the
                        <a
                          href="https://www.mongodb.org/docs/manual/reference/operator/aggregation/group/
"
                          ><code>$group</code></a
                        >
                        stage, the Java driver provides
                        <a
                          href="/mongo-java-driver/4.10/apidocs/mongodb-driver-core/com/mongodb/client/model/Accumulators.html
"
                          ><code>Accumulators</code></a
                        >
                        helper class.
                      </p>
                    </li>
                  </ul>

                  <pre><code class="language-java">collection.aggregate(
      Arrays.asList(
              Aggregates.match(Filters.eq(&quot;categories&quot;, &quot;Bakery&quot;)),
              Aggregates.group(&quot;$stars&quot;, Accumulators.sum(&quot;count&quot;, 1))
      )
).subscribe(new PrintDocumentSubscriber());
</code></pre>

                  <h3 id="use-aggregation-expressions">
                    Use Aggregation Expressions
                  </h3>

                  <p>
                    For
                    <a
                      href="https://www.mongodb.org/docs/manual/reference/operator/aggregation-group/
"
                      >$group accumulator expressions</a
                    >, the Java driver provides
                    <a
                      href="/mongo-java-driver/4.10/apidocs/mongodb-driver-core/com/mongodb/client/model/Accumulators.html
"
                      ><code>Accumulators</code></a
                    >
                    helper class. For other
                    <a
                      href="https://www.mongodb.org/docs/manual/meta/aggregation-quick-reference/#aggregation-expressions
"
                      >aggregation expressions</a
                    >, manually build the expression <code>Document</code>.
                  </p>

                  <p>
                    In the following example, the aggregation pipeline uses a
                    <a
                      href="https://www.mongodb.org/docs/manual/reference/operator/aggregation/project/
"
                      ><code>$project</code></a
                    >
                    stage to return only the <code>name</code> field and the
                    calculated field <code>firstCategory</code> whose value is
                    the first element in the <code>categories</code> array. The
                    example uses
                    <a
                      href="/mongo-java-driver/4.10/builders/aggregation/#project"
                      ><code>Aggregates.project</code></a
                    >
                    and various
                    <a
                      href="/mongo-java-driver/4.10/apidocs/mongodb-driver-core/com/mongodb/client/model/Projections.html
"
                      ><code>Projections</code></a
                    >
                    methods to build the <code>$project</code> stage.
                  </p>

                  <pre><code class="language-java">collection.aggregate(
      Arrays.asList(
          Aggregates.project(
              Projections.fields(
                    Projections.excludeId(),
                    Projections.include(&quot;name&quot;),
                    Projections.computed(
                            &quot;firstCategory&quot;,
                            new Document(&quot;$arrayElemAt&quot;, Arrays.asList(&quot;$categories&quot;, 0))
                    )
              )
          )
      )
).subscribe(new PrintDocumentSubscriber());
</code></pre>

                  <h3 id="explain-an-aggregation">Explain an Aggregation</h3>

                  <p>
                    To
                    <a
                      href="https://www.mongodb.org/docs/manual/reference/command/explain/
"
                      >explain</a
                    >
                    an aggregation pipeline, call the
                    <a
                      href="/mongo-java-driver/4.10/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/AggregatePublisher.html#explain()
"
                      ><code>AggregatePublisher.explain()</code></a
                    >
                    method:
                  </p>

                  <pre><code class="language-java">collection.aggregate(
      Arrays.asList(
              Aggregates.match(Filters.eq(&quot;categories&quot;, &quot;Bakery&quot;)),
              Aggregates.group(&quot;$stars&quot;, Accumulators.sum(&quot;count&quot;, 1))))
      .explain()
      .subscribe(new PrintDocumentSubscriber());
</code></pre>

                  <p>
                    The driver supports explain of aggregation pipelines
                    starting with MongoDB 3.6.
                  </p>
                  <div id="btnv">
                    <div class="pull-left">
                      <a
                        class="navigation prev"
                        href="/mongo-java-driver/4.10/driver-reactive/tutorials/perform-write-operations/"
                      >
                        <i class="fa fa-long-arrow-left"> </i> Write Operations
                      </a>
                    </div>
                    <div class="pull-right">
                      <a
                        class="navigation next"
                        href="/mongo-java-driver/4.10/driver-reactive/tutorials/change-streams/"
                      >
                        Change Streams <i class="fa fa-long-arrow-right"> </i>
                      </a>
                    </div>
                  </div>
                </div>
                <div class="right-column">
                  <div class="wrapper">
                    <div class="toc">
                      <span class="toc-header">On this page</span>
                      <nav id="TableOfContents">
                        <ul>
                          <li>
                            <ul>
                              <li>
                                <a href="#aggregation-framework"
                                  >Aggregation Framework</a
                                >
                              </li>
                              <li>
                                <a href="#prerequisites">Prerequisites</a>
                              </li>
                              <li>
                                <a href="#connect-to-a-mongodb-deployment"
                                  >Connect to a MongoDB Deployment</a
                                >
                              </li>
                              <li>
                                <a href="#perform-aggregation"
                                  >Perform Aggregation</a
                                >
                                <ul>
                                  <li>
                                    <a href="#use-aggregation-expressions"
                                      >Use Aggregation Expressions</a
                                    >
                                  </li>
                                  <li>
                                    <a href="#explain-an-aggregation"
                                      >Explain an Aggregation</a
                                    >
                                  </li>
                                </ul>
                              </li>
                            </ul>
                          </li>
                        </ul>
                      </nav>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </section>
    </section>

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT: "/mongo-java-driver/4.10",
        VERSION: "4.10.0",
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: ".html",
        HAS_SOURCE: true,
      };
    </script>
    <script
      type="text/javascript"
      src="/mongo-java-driver/4.10/js/jquery.js"
    ></script>
    <script
      type="text/javascript"
      src="/mongo-java-driver/4.10/lib/bootstrap.js"
    ></script>
    <script
      type="text/javascript"
      src="/mongo-java-driver/4.10/js/navbar.js"
    ></script>
    <script
      type="text/javascript"
      src="/mongo-java-driver/4.10/lib/highlight/highlight.pack.js"
    ></script>
    <script
      type="text/javascript"
      src="/mongo-java-driver/4.10/js/scripts.js"
    ></script>
    <script
      type="text/javascript"
      src="/mongo-java-driver/4.10/lib/delighted.js"
    ></script>
    <script
      type="text/javascript"
      src="/mongo-java-driver/4.10/lib/bootstrap-toggle/bootstrap-toggle.min.js"
    ></script>
    <script
      type="text/javascript"
      src="/mongo-java-driver/4.10/js/java.js"
    ></script>

    <noscript
      ><iframe
        src="//www.googletagmanager.com/ns.html?id=UA-7301842-14"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe
    ></noscript>
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "//www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "UA-7301842-14");
    </script>

    <script type="text/javascript">
      var _elqQ = _elqQ || [];
      _elqQ.push(["elqSetSiteId", "413370795"]);
      _elqQ.push(["elqTrackPageView"]);
      (function () {
        function async_load() {
          var s = document.createElement("script");
          s.type = "text/javascript";
          s.async = true;
          s.src = "//img03.en25.com/i/elqCfg.min.js";
          var x = document.getElementsByTagName("script")[0];
          x.parentNode.insertBefore(s, x);
        }
        if (window.addEventListener)
          window.addEventListener("DOMContentLoaded", async_load, false);
        else if (window.attachEvent) window.attachEvent("onload", async_load);
      })();
    </script>
  </body>
</html>
